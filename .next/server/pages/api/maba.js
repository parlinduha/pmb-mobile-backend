"use strict";(()=>{var e={};e.id=132,e.ids=[132],e.modules={1738:e=>{e.exports=require("multer")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},9267:e=>{e.exports=require("nextjs-cors")},7147:e=>{e.exports=require("fs")},1017:e=>{e.exports=require("path")},6249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,t){return t in r?r[t]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,t)):"function"==typeof r&&"default"===t?r:void 0}}})},8637:(e,r,t)=>{t.r(r),t.d(r,{config:()=>y,default:()=>b,routeModule:()=>E});var a={};t.r(a),t.d(a,{default:()=>P});var o=t(1802),i=t(7153),n=t(6249),s=t(2814),l=t(9267),u=t.n(l),d=t(1738),c=t.n(d),m=t(1017),f=t.n(m),h=t(5124);let p=c()({storage:c().diskStorage({destination:f().join(process.cwd(),"../../../public/uploads"),filename:(e,r,t)=>{t(null,`${Date.now()}-${r.originalname}`)}}),fileFilter:(e,r,t)=>{r.mimetype.startsWith("image/")?t(null,!0):t(Error("Only image files are allowed"))},limits:{fileSize:716800}}),g=(e,r,t)=>new Promise((a,o)=>{t(e,r,e=>e instanceof Error?o(e):a(e))}),P=async(e,r)=>{if(await u()(e,r,{methods:["GET","HEAD","PUT","PATCH","POST","DELETE"],origin:"*",optionsSuccessStatus:200}),r.setHeader("Content-Type","application/json"),"GET"===e.method){let e=await (0,s.R)();return r.status(200).json({success:!0,message:"Data Found",data:e})}if("POST"!==e.method)return r.status(405).json({error:"Method Not Allowed"});try{if(await g(e,r,p.single("paymentProof")),!e.body.data)throw Error("No data found in request body");let t=JSON.parse(e.body.data),a=await (0,s.R)();if(a.find(e=>e.email===t.email))return r.status(400).json({error:"Email sudah terdaftar!"});if(!(await (0,h.o9)()).find(e=>e.email===t.email))return r.status(400).json({error:"Email belum terdaftar."});let o={id:(a.length+1).toString(),major1:t.major1,major2:t.major2,wavePeriod:t.wavePeriod,class:t.class,fullName:t.fullName,gender:t.gender,birthPlace:t.birthPlace,birthDate:t.birthDate,homePhoneAreaCode:t.homePhoneAreaCode,homePhoneNumber:t.homePhoneNumber,mobileNumber:t.mobileNumber,fullAddress:t.fullAddress,subDistrict:t.subDistrict,district:t.district,city:t.city,province:t.province,email:t.email,graduationYear:t.graduationYear,diplomaNumber:t.diplomaNumber,schoolOrigin:t.schoolOrigin,religion:t.religion,fatherName:t.fatherName,fatherAddress:t.fatherAddress,fatherOccupation:t.fatherOccupation,fatherMobileNumber:t.fatherMobileNumber,motherName:t.motherName,motherAddress:t.motherAddress,motherOccupation:t.motherOccupation,motherMobileNumber:t.motherMobileNumber,paymentProof:e.file?e.file.filename:""};return a.push(o),await (0,s.F)(a),r.status(200).json({success:!0,message:"Registrasi berhasil",data:o})}catch(e){return console.error("Error during data handling:",e.message),r.status(500).json({error:"Error processing data.",details:e.message})}},b=(0,n.l)(a,"default"),y=(0,n.l)(a,"config"),E=new o.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/maba",pathname:"/api/maba",bundlePath:"",filename:""},userland:a})},2814:(e,r,t)=>{t.d(r,{F:()=>l,R:()=>s});var a=t(7147),o=t.n(a),i=t(1017);let n=t.n(i)().join(process.cwd(),"data","people.json"),s=()=>{try{console.log("studentsFilePath:",n);let e=o().readFileSync(n,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading students.json:",e),[]}},l=e=>{try{o().writeFileSync(n,JSON.stringify(e,null,2),"utf-8")}catch(e){console.error("Error writing to students.json:",e)}}},5124:(e,r,t)=>{t.d(r,{Oo:()=>s,X7:()=>l,o9:()=>u});var a=t(7147),o=t.n(a),i=t(1017);let n=t.n(i)().join(process.cwd(),"data","students.json"),s=()=>{try{console.log("studentsFilePath:",n);let e=o().readFileSync(n,"utf-8");return JSON.parse(e)}catch(e){return console.error("Error reading students.json:",e),[]}},l=e=>{try{o().writeFileSync(n,JSON.stringify(e,null,2),"utf-8")}catch(e){console.error("Error writing to students.json:",e)}},u=()=>{try{let e=o().readFileSync(n,"utf8");return JSON.parse(e)}catch(e){return console.error("Error reading validEmails.json:",e),[]}}},7153:(e,r)=>{var t;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(e,r,t)=>{e.exports=t(145)}};var r=require("../../webpack-api-runtime.js");r.C(e);var t=r(r.s=8637);module.exports=t})();